<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Py Corner - Your interactive Python learning hub. No code to pro code, all in one corner. Practice with infinite randomized questions, get AI-powered explanations, and level up your skills.">
<meta name="keywords" content="Python learning, Python quiz, coding practice, programming tutorial, learn Python online">
<meta name="author" content="Py Corner">
<meta name="theme-color" content="#00b4cc">

<!-- Open Graph / Social Media -->
<meta property="og:type" content="website">
<meta property="og:title" content="Py Corner - Interactive Python Learning">
<meta property="og:description" content="No code to pro code â€” all in one corner">
<meta property="og:image" content="https://via.placeholder.com/1200x630/00b4cc/ffffff?text=Py+Corner">

<!-- PWA / Mobile -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="mobile-web-app-capable" content="yes">

<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%2300b4cc'/%3E%3Cstop offset='100%25' style='stop-color:%23f5c518'/%3E%3C/linearGradient%3E%3C/defs%3E%3Cpath d='M50 20Q35 20 25 30Q20 35 20 42L20 52Q20 58 25 58L48 58L48 62Q48 68 54 68L75 68Q80 68 80 62L80 35Q80 28 74 22Q68 18 60 18L50 18Z' fill='url(%23g)'/%3E%3Cpath d='M50 80Q65 80 75 70Q80 65 80 58L80 48Q80 42 75 42L52 42L52 38Q52 32 46 32L25 32Q20 32 20 38L20 65Q20 72 26 78Q32 82 40 82L50 82Z' fill='url(%23g)' opacity='0.8'/%3E%3Ccircle cx='42' cy='28' r='3.5' fill='%23fff'/%3E%3Ccircle cx='58' cy='72' r='3.5' fill='%23fff'/%3E%3C/svg%3E">

<title>Py Corner - Interactive Python Learning Hub</title>

<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FOUNDATION & VARIABLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*{margin:0;padding:0;box-sizing:border-box;}
:root{
  --teal-1:#00b4cc;--teal-2:#007a8a;--teal-3:#005f6b;--teal-4:#003d47;
  --bg:#f0fdfe;--card:#fff;--text:#1a3a40;--muted:#4a8a95;
  --gold:#f5c518;--green:#2ecc71;--red:#e74c3c;--orange:#ff6b35;
}

/* Smooth scroll */
html{scroll-behavior:smooth;}

body{
  font-family:'Segoe UI',system-ui,-apple-system,sans-serif;
  background:linear-gradient(145deg,var(--teal-1) 0%,var(--teal-2) 40%,var(--teal-3) 70%,var(--teal-4) 100%);
  min-height:100vh;padding:20px;display:flex;justify-content:center;align-items:flex-start;
  position:relative;overflow-x:hidden;
}

/* Python watermark */
body::before{
  content:'';position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
  width:700px;height:700px;pointer-events:none;z-index:0;opacity:1;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 110 110'%3E%3Cpath fill='none' stroke='rgba(255,255,255,0.08)' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round' d='M54.9 5.2c-17.2 0-16.1 7.5-16.1 7.5v7.7h16.4v2.3H32.6S22 21.4 22 38.8c0 17.4 9.6 16.8 9.6 16.8h5.8v-8.1s-.3-9.6 9.4-9.6h16.2s9.1.1 9.1-8.8V13.4s1.4-8.2-17.2-8.2zm-9 5.2c1.7 0 3 1.4 3 3s-1.4 3-3 3-3-1.4-3-3 1.4-3 3-3z'/%3E%3Cpath fill='none' stroke='rgba(255,255,255,0.08)' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round' d='M55.1 104.8c17.2 0 16.1-7.5 16.1-7.5v-7.7H54.8v-2.3h22.6s10.6 1.3 10.6-16.1c0-17.4-9.6-16.8-9.6-16.8h-5.8v8.1s.3 9.6-9.4 9.6H47.1s-9.1-.1-9.1 8.8v15.7s-1.4 8.2 17.1 8.2zm9-5.2c-1.7 0-3-1.4-3-3s1.4-3 3-3 3 1.4 3 3-1.3 3-3 3z'/%3E%3C/svg%3E");
  background-repeat:no-repeat;background-position:center;background-size:contain;
}

/* Particles */
.particles{position:fixed;inset:0;pointer-events:none;z-index:0;overflow:hidden;}
.particle{position:absolute;border-radius:50%;background:rgba(255,255,255,0.05);animation:float linear infinite;}
@keyframes float{
  0%{transform:translateY(100vh) rotate(0deg);opacity:0;}
  10%{opacity:1;}90%{opacity:1;}
  100%{transform:translateY(-150px) rotate(720deg);opacity:0;}
}

.container{
  position:relative;z-index:1;
  background:rgba(240,253,254,0.98);border-radius:24px;
  box-shadow:0 24px 80px rgba(0,60,80,0.5),0 0 0 1px rgba(255,255,255,0.35);
  max-width:960px;width:100%;overflow:hidden;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.header{
  background:linear-gradient(135deg,var(--teal-1) 0%,var(--teal-3) 100%);
  padding:32px 40px 28px;position:relative;overflow:hidden;
}
.header::after{
  content:'';position:absolute;right:-60px;top:-60px;
  width:220px;height:220px;border-radius:50%;background:rgba(255,255,255,0.06);
}

.header-top{display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:16px;position:relative;z-index:1;}
.brand{display:flex;align-items:center;gap:16px;}

/* Enhanced logo with gradient */
.brand-logo{
  width:64px;height:64px;
  background:linear-gradient(135deg,rgba(255,255,255,0.25),rgba(255,255,255,0.15));
  border-radius:18px;
  display:flex;align-items:center;justify-content:center;
  border:2.5px solid rgba(255,255,255,0.4);
  box-shadow:0 6px 20px rgba(0,0,0,0.25),inset 0 1px 0 rgba(255,255,255,0.3);
  position:relative;overflow:hidden;
  transition:transform 0.3s ease;
}
.brand-logo:hover{transform:scale(1.05) rotate(2deg);}
.brand-logo svg{width:75%;height:75%;filter:drop-shadow(0 2px 4px rgba(0,0,0,0.2));}

.brand-text h1{
  color:white;font-size:2.2em;font-weight:800;letter-spacing:-1px;line-height:1;
  text-shadow:0 2px 10px rgba(0,0,0,0.25);
}
.brand-text .slogan{
  color:rgba(255,255,255,0.88);font-size:0.88em;margin-top:4px;
  font-style:italic;letter-spacing:0.3px;
}

.level-display{
  background:rgba(255,255,255,0.15);border:2px solid rgba(255,255,255,0.35);
  border-radius:14px;padding:11px 20px;text-align:center;color:white;
  backdrop-filter:blur(8px);
}
.level-label{font-size:0.72em;opacity:0.85;text-transform:uppercase;letter-spacing:1px;margin-bottom:2px;}
.level-value{font-size:1.15em;font-weight:700;}

.xp-section{position:relative;z-index:1;margin-top:20px;display:flex;align-items:center;gap:16px;}
.xp-label{color:rgba(255,255,255,0.82);font-size:0.8em;white-space:nowrap;min-width:80px;}
.xp-bar{
  flex:1;height:10px;background:rgba(255,255,255,0.22);border-radius:12px;overflow:hidden;
  box-shadow:inset 0 2px 6px rgba(0,0,0,0.15);
}
.xp-fill{
  height:100%;background:linear-gradient(90deg,#f0e040,var(--gold));border-radius:12px;
  width:0%;transition:width 0.7s cubic-bezier(0.34,1.56,0.64,1);
  box-shadow:0 0 10px rgba(245,197,24,0.7);
}
.xp-points{color:white;font-size:0.82em;font-weight:700;min-width:70px;text-align:right;}

/* Stats */
.stats{display:flex;gap:0;background:var(--teal-3);}
.stat{
  flex:1;padding:16px 12px;text-align:center;color:white;
  border-right:1px solid rgba(255,255,255,0.1);transition:background 0.25s;cursor:default;
}
.stat:last-child{border-right:none;}
.stat:hover{background:rgba(255,255,255,0.08);}
.stat-icon{font-size:1.15em;margin-bottom:3px;}
.stat-label{font-size:0.72em;text-transform:uppercase;letter-spacing:0.9px;opacity:0.82;margin-bottom:5px;}
.stat-value{font-size:1.75em;font-weight:800;line-height:1;}

/* Motivation */
.motivation{
  background:linear-gradient(90deg,#fff8e1,#fffde7);border-bottom:2px solid var(--gold);
  padding:11px 28px;display:flex;align-items:center;gap:12px;
  font-size:0.9em;color:#5a4400;font-weight:500;transition:all 0.5s ease;
}
.motivation-icon{font-size:1.25em;flex-shrink:0;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONTENT AREA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.content{padding:36px 40px;}

.q-meta{display:flex;align-items:center;gap:12px;margin-bottom:10px;}
.q-number{font-size:0.82em;color:var(--muted);font-weight:600;}
.q-points{font-size:0.82em;color:var(--gold);font-weight:700;background:#1a3a40;padding:3px 11px;border-radius:12px;}

.q-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:12px;}
.q-type{
  background:var(--teal-1);color:white;padding:7px 20px;border-radius:24px;
  font-size:0.9em;font-weight:700;letter-spacing:0.4px;
  box-shadow:0 3px 12px rgba(0,150,180,0.35);
}
.topic{background:#d0f4f8;color:var(--teal-3);padding:6px 16px;border-radius:24px;font-size:0.85em;font-weight:600;}
.difficulty{padding:6px 16px;border-radius:24px;font-size:0.84em;font-weight:700;}
.difficulty-easy{background:#d4f5e2;color:#1a6637;}
.difficulty-medium{background:#fff3cd;color:#856404;}
.difficulty-hard{background:#ffe0e0;color:#b71c1c;}

.question{font-size:1.2em;color:var(--text);line-height:1.7;font-weight:600;margin-bottom:20px;}

/* Code blocks */
.code-block{
  background:#0f1419;color:#d4d4d4;padding:20px 22px;border-radius:14px;
  font-family:'SF Mono','Monaco','Inconsolata','Roboto Mono','Courier New',monospace;
  margin:16px 0;overflow-x:auto;line-height:1.75;
  border-left:4px solid var(--teal-1);box-shadow:0 4px 20px rgba(0,0,0,0.3);
  position:relative;
}
.code-block::before{
  content:'Python';position:absolute;top:10px;right:14px;
  font-size:0.7em;color:rgba(255,255,255,0.25);
  font-family:'Segoe UI',sans-serif;text-transform:uppercase;letter-spacing:1.2px;
}
.kw{color:#569cd6;font-weight:600;}
.str{color:#ce9178;}
.num{color:#b5cea8;}
.cmt{color:#6a9955;font-style:italic;}
.fn{color:#dcdcaa;}

/* Code input */
.code-input-area{margin:20px 0;}
.hint-box{
  background:#e8f9fb;border:2px dashed var(--teal-1);border-radius:12px;
  padding:14px 18px;margin-bottom:14px;display:flex;align-items:flex-start;gap:12px;
}
.hint-icon{font-size:1.4em;flex-shrink:0;}
.hint-label{font-weight:700;color:var(--teal-3);font-size:0.88em;margin-bottom:4px;}
.hint-text{font-size:0.92em;color:var(--muted);line-height:1.6;}

textarea.code-input{
  width:100%;min-height:120px;padding:18px;border:2px solid #b0dce4;border-radius:14px;
  font-family:'SF Mono','Monaco','Inconsolata','Courier New',monospace;font-size:1em;
  resize:vertical;background:#0f1419;color:#d4d4d4;line-height:1.7;
  box-shadow:inset 0 2px 10px rgba(0,0,0,0.25);transition:border-color 0.3s,box-shadow 0.3s;
}
textarea.code-input::placeholder{color:rgba(255,255,255,0.3);}
textarea.code-input:focus{outline:none;border-color:var(--teal-1);box-shadow:inset 0 2px 10px rgba(0,0,0,0.25),0 0 0 3px rgba(0,180,204,0.15);}

/* Options */
.options{display:flex;flex-direction:column;gap:13px;}
.option{
  background:white;border:2.5px solid #c8eef5;padding:16px 22px;border-radius:14px;
  cursor:pointer;transition:all 0.25s cubic-bezier(0.34,1.56,0.64,1);
  display:flex;align-items:center;gap:16px;
  box-shadow:0 2px 10px rgba(0,100,120,0.08);
}
.option:hover{background:#e4f8fc;border-color:var(--teal-1);transform:translateX(6px);box-shadow:0 4px 16px rgba(0,140,170,0.18);}
.option.selected{background:#cdf2f8;border-color:var(--teal-1);transform:translateX(6px);}
.option.correct{background:#d4f5e2;border-color:#27ae60;transform:none;}
.option.incorrect{background:#ffe4e4;border-color:var(--red);transform:none;}
.option-letter{
  background:#e0f4f8;border:2.5px solid #a0dce4;width:36px;height:36px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--teal-3);flex-shrink:0;font-size:0.92em;
}
.option.selected .option-letter{background:var(--teal-1);border-color:var(--teal-1);color:white;}
.option.correct .option-letter{background:#27ae60;border-color:#27ae60;color:white;}
.option.incorrect .option-letter{background:var(--red);border-color:var(--red);color:white;}
.option-text{color:var(--text);font-weight:500;font-size:1.02em;}

/* Feedback */
.feedback{padding:15px 20px;margin-top:16px;border-radius:12px;display:none;font-weight:500;align-items:center;gap:12px;}
.feedback.show{display:flex;}
.feedback.correct{background:#d4f5e2;border-left:4px solid #27ae60;color:#1a4a2a;}
.feedback.incorrect{background:#ffe4e4;border-left:4px solid var(--red);color:#7a1010;}

/* Explanation */
.explanation{
  background:#fffbe6;border:2px solid #f0d060;border-radius:14px;
  padding:18px 22px;margin-top:22px;display:none;
}
.explanation.show{display:block;}
.explanation-title{font-weight:700;color:#7a5c00;margin-bottom:10px;font-size:0.97em;display:flex;align-items:center;gap:10px;}
.explanation-text{color:#5a4400;line-height:1.75;font-size:0.98em;}

/* Retry badge */
.retry-badge{
  display:inline-flex;align-items:center;gap:8px;background:#fff3e0;
  border:2px solid #ffb74d;border-radius:24px;padding:8px 18px;
  font-size:0.86em;color:#e65100;font-weight:600;margin-top:12px;
  box-shadow:0 2px 8px rgba(230,81,0,0.15);
}

/* Buttons */
.buttons{display:flex;gap:14px;margin-top:30px;flex-wrap:wrap;}
button{
  padding:14px 30px;border:none;border-radius:14px;font-size:1em;
  cursor:pointer;transition:all 0.25s cubic-bezier(0.34,1.56,0.64,1);font-weight:700;
}
.btn-primary{
  background:linear-gradient(135deg,var(--teal-1),var(--teal-2));color:white;
  flex:1;min-width:140px;box-shadow:0 4px 16px rgba(0,140,180,0.4);
}
.btn-primary:hover{transform:translateY(-3px);box-shadow:0 8px 24px rgba(0,140,180,0.5);}
.btn-primary:active{transform:translateY(-1px);}
.btn-primary:disabled{background:#b0cdd1;cursor:not-allowed;transform:none;box-shadow:none;}

.btn-secondary{background:#d0eef2;color:var(--teal-3);}
.btn-secondary:hover{background:#b0dde5;transform:translateY(-3px);}

.btn-explain{
  background:linear-gradient(135deg,var(--gold),#e0a800);color:#2a1a00;
  display:flex;align-items:center;gap:9px;box-shadow:0 4px 16px rgba(200,160,0,0.35);
}
.btn-explain:hover{transform:translateY(-3px);box-shadow:0 8px 22px rgba(200,160,0,0.45);}
.btn-explain:disabled{background:#ddd;color:#999;cursor:not-allowed;transform:none;box-shadow:none;}

.btn-retry{
  background:linear-gradient(135deg,#ff6b6b,#e53935);color:white;
  display:flex;align-items:center;gap:9px;box-shadow:0 4px 16px rgba(229,57,53,0.4);
  animation:pulse-retry 1.8s ease-in-out infinite;
}
.btn-retry:hover{transform:translateY(-3px);box-shadow:0 8px 22px rgba(229,57,53,0.5);animation:none;}
@keyframes pulse-retry{
  0%,100%{box-shadow:0 4px 16px rgba(229,57,53,0.4);}
  50%{box-shadow:0 4px 24px rgba(229,57,53,0.7);}
}

@keyframes shake{
  0%,100%{transform:translateX(0);}20%{transform:translateX(-7px);}
  40%{transform:translateX(7px);}60%{transform:translateX(-5px);}80%{transform:translateX(5px);}
}

/* Breakdown box styles - condensed for space */
.breakdown{background:white;border:2.5px solid #00c9a7;border-radius:20px;margin-top:26px;display:none;overflow:hidden;box-shadow:0 10px 40px rgba(0,100,120,0.2);animation:slideUp 0.4s cubic-bezier(0.34,1.56,0.64,1);}
.breakdown.show{display:block;}
@keyframes slideUp{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
.breakdown-header{background:linear-gradient(135deg,#00c9a7,#008f7a);padding:18px 26px;display:flex;align-items:center;gap:16px;}
.breakdown-header-icon{width:48px;height:48px;background:rgba(255,255,255,0.2);border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:1.6em;border:2px solid rgba(255,255,255,0.35);}
.breakdown-header-info{flex:1;}
.breakdown-header-title{color:white;font-weight:800;font-size:1.1em;}
.breakdown-header-sub{color:rgba(255,255,255,0.82);font-size:0.82em;margin-top:3px;}
.breakdown-content{padding:26px 28px;}
.what-is{background:linear-gradient(135deg,#e8fafb,#d0f4f8);border-radius:14px;padding:16px 20px;margin-bottom:22px;border-left:4px solid var(--teal-1);display:flex;align-items:flex-start;gap:14px;}
.what-icon{font-size:1.5em;flex-shrink:0;margin-top:2px;}
.what-text{color:var(--teal-3);font-weight:600;line-height:1.7;font-size:0.99em;}
.step{background:#f8fffe;border:2px solid #c0ede4;border-radius:16px;margin-bottom:18px;overflow:hidden;transition:box-shadow 0.3s;}
.step:hover{box-shadow:0 6px 20px rgba(0,120,100,0.14);}
.step-header{display:flex;align-items:center;gap:14px;padding:14px 20px;background:linear-gradient(90deg,#e0faf5,#f0fdfa);border-bottom:2px solid #c0ede4;}
.step-num{width:32px;height:32px;background:linear-gradient(135deg,var(--teal-1),var(--teal-2));color:white;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:0.9em;flex-shrink:0;box-shadow:0 3px 10px rgba(0,140,170,0.4);}
.step-title{font-weight:700;color:var(--teal-3);font-size:0.98em;}
.step-body{padding:16px 20px;color:var(--text);line-height:1.8;font-size:0.97em;}
.example{background:#0f1419;border-radius:12px;margin-top:16px;overflow:hidden;border:2px solid rgba(0,180,210,0.35);box-shadow:0 4px 14px rgba(0,0,0,0.25);}
.example-header{background:linear-gradient(90deg,rgba(0,180,204,0.15),rgba(0,122,138,0.15));padding:8px 16px;display:flex;align-items:center;gap:10px;border-bottom:1px solid rgba(255,255,255,0.08);}
.example-dots{display:flex;gap:6px;}
.dot{width:11px;height:11px;border-radius:50%;}
.dot-r{background:#ff6058;}.dot-y{background:#ffbd2e;}.dot-g{background:#28ca41;}
.example-label{color:rgba(255,255,255,0.5);font-size:0.76em;font-family:monospace;margin-left:6px;}
.example-code{padding:16px 20px;font-family:'SF Mono','Monaco','Courier New',monospace;font-size:0.95em;color:#d4d4d4;line-height:1.8;white-space:pre-wrap;word-break:break-word;}
.example-output{border-top:1px solid rgba(255,255,255,0.08);padding:12px 20px;background:rgba(0,0,0,0.25);}
.output-label{font-size:0.73em;color:rgba(255,255,255,0.4);font-family:monospace;margin-bottom:5px;text-transform:uppercase;letter-spacing:1.2px;}
.output-value{color:#90ee90;font-family:monospace;font-size:0.92em;}
.analogy{background:linear-gradient(135deg,#fffbe6,#fff8d6);border-radius:14px;padding:18px 20px;margin-top:18px;border-left:4px solid var(--gold);display:flex;align-items:flex-start;gap:14px;}
.analogy-icon{font-size:1.6em;flex-shrink:0;}
.analogy-title{font-weight:700;color:#7a5c00;margin-bottom:6px;font-size:0.92em;text-transform:uppercase;letter-spacing:0.6px;}
.analogy-text{color:#5a4400;line-height:1.75;font-size:0.97em;font-style:italic;}
.tip{background:linear-gradient(135deg,#e8f9fb,#d0f4f8);border-radius:14px;padding:16px 20px;margin-top:14px;border-left:4px solid var(--teal-1);display:flex;align-items:flex-start;gap:14px;}
.tip-icon{font-size:1.4em;flex-shrink:0;}
.tip-title{font-weight:700;color:var(--teal-3);margin-bottom:5px;font-size:0.9em;text-transform:uppercase;letter-spacing:0.6px;}
.tip-text{color:var(--muted);line-height:1.7;font-size:0.95em;}
.loading{display:flex;align-items:center;gap:16px;color:#006655;font-style:italic;padding:12px 0;font-size:0.97em;}
.spinner{width:26px;height:26px;border:3px solid #a0e8dc;border-top-color:var(--teal-1);border-radius:50%;animation:spin 0.75s linear infinite;flex-shrink:0;}
@keyframes spin{to{transform:rotate(360deg);}}

/* Toast */
.toast{position:fixed;top:28px;right:28px;z-index:9999;background:linear-gradient(135deg,#1a3a40,#0d2b30);color:white;border-radius:18px;padding:18px 26px;display:flex;align-items:center;gap:16px;box-shadow:0 10px 40px rgba(0,0,0,0.5);border:2px solid rgba(0,180,210,0.45);transform:translateX(150%);transition:transform 0.5s cubic-bezier(0.34,1.56,0.64,1);max-width:340px;}
.toast.show{transform:translateX(0);}
.toast-icon{font-size:2.2em;flex-shrink:0;}
.toast-title{font-weight:700;font-size:0.97em;margin-bottom:3px;}
.toast-msg{font-size:0.82em;color:rgba(255,255,255,0.72);}

/* Footer with feedback */
.footer{background:var(--teal-4);padding:16px 28px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;}
.footer-text{color:rgba(255,255,255,0.42);font-size:0.8em;letter-spacing:0.4px;}
.feedback-btn{
  background:linear-gradient(135deg,var(--gold),#e0a800);color:#2a1a00;
  padding:9px 20px;border-radius:20px;font-size:0.85em;font-weight:700;
  border:none;cursor:pointer;transition:all 0.3s ease;
  box-shadow:0 3px 10px rgba(200,160,0,0.3);
}
.feedback-btn:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(200,160,0,0.45);}

/* Keyboard shortcuts hint */
.kbd{
  display:inline-block;padding:2px 8px;border-radius:5px;
  background:#f0f0f0;border:1px solid #ccc;
  font-family:monospace;font-size:0.85em;
  box-shadow:0 1px 2px rgba(0,0,0,0.1);
}

@media(max-width:600px){
  .header{padding:24px 20px;}
  .content{padding:24px 20px;}
  .brand-text h1{font-size:1.6em;}
  .stat-value{font-size:1.4em;}
  .footer{flex-direction:column;text-align:center;}
}
</style>
</head>
<body>

<div class="particles" id="particles"></div>

<div class="toast" id="toast">
  <div class="toast-icon" id="toastIcon">ğŸ†</div>
  <div>
    <div class="toast-title" id="toastTitle">Achievement!</div>
    <div class="toast-msg" id="toastMsg">Keep it up!</div>
  </div>
</div>

<div class="container">
  <div class="header">
    <div class="header-top">
      <div class="brand">
        <div class="brand-logo">
          <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="snakeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#00d4e8;stop-opacity:1"/>
                <stop offset="50%" style="stop-color:#00b4cc;stop-opacity:1"/>
                <stop offset="100%" style="stop-color:#f5c518;stop-opacity:1"/>
              </linearGradient>
            </defs>
            <path d="M50 20Q35 20 25 30Q20 35 20 42L20 52Q20 58 25 58L48 58L48 62Q48 68 54 68L75 68Q80 68 80 62L80 35Q80 28 74 22Q68 18 60 18L50 18Z" 
                  fill="url(#snakeGrad)" stroke="rgba(255,255,255,0.6)" stroke-width="1.5"/>
            <path d="M50 80Q65 80 75 70Q80 65 80 58L80 48Q80 42 75 42L52 42L52 38Q52 32 46 32L25 32Q20 32 20 38L20 65Q20 72 26 78Q32 82 40 82L50 82Z" 
                  fill="url(#snakeGrad)" opacity="0.85" stroke="rgba(255,255,255,0.5)" stroke-width="1.5"/>
            <circle cx="42" cy="28" r="4" fill="#fff"/>
            <circle cx="58" cy="72" r="4" fill="#fff"/>
          </svg>
        </div>
        <div class="brand-text">
          <h1>Py Corner</h1>
          <div class="slogan">No code to pro code â€” all in one corner</div>
        </div>
      </div>
      <div class="level-display">
        <div class="level-label">Your Level</div>
        <div class="level-value" id="levelValue">ğŸŒ± Seedling</div>
      </div>
    </div>
    <div class="xp-section">
      <div class="xp-label">âš¡ XP Progress</div>
      <div class="xp-bar"><div class="xp-fill" id="xpFill"></div></div>
      <div class="xp-points" id="xpPoints">0 / 100 XP</div>
    </div>
  </div>

  <div class="stats">
    <div class="stat">
      <div class="stat-icon">ğŸ“</div>
      <div class="stat-label">Answered</div>
      <div class="stat-value" id="statTotal">0</div>
    </div>
    <div class="stat">
      <div class="stat-icon">âœ…</div>
      <div class="stat-label">Correct</div>
      <div class="stat-value" id="statCorrect">0</div>
    </div>
    <div class="stat">
      <div class="stat-icon">ğŸ¯</div>
      <div class="stat-label">Accuracy</div>
      <div class="stat-value" id="statAccuracy">â€”</div>
    </div>
    <div class="stat">
      <div class="stat-icon">ğŸ”¥</div>
      <div class="stat-label">Streak</div>
      <div class="stat-value" id="statStreak">0</div>
    </div>
    <div class="stat">
      <div class="stat-icon">â­</div>
      <div class="stat-label">Best</div>
      <div class="stat-value" id="statBest">0</div>
    </div>
  </div>

  <div class="motivation" id="motivation">
    <span class="motivation-icon">ğŸ’¡</span>
    <span id="motivationText">Every expert was once a beginner. Your first line of code was the hardest â€” everything after is momentum!</span>
  </div>

  <div class="content">
    <div id="quizContent"></div>
  </div>

  <div class="footer">
    <div class="footer-text">Py Corner Â· Built for learners Â· Practice makes permanent ğŸ</div>
    <button class="feedback-btn" onclick="openFeedback()">ğŸ’¬ Share Feedback</button>
  </div>
</div>

<script>
// Particles
(function(){
  const p=document.getElementById('particles');
  for(let i=0;i<20;i++){
    const d=document.createElement('div');
    d.className='particle';
    const sz=6+Math.random()*22;
    d.style.cssText=`width:${sz}px;height:${sz}px;left:${Math.random()*100}%;animation-duration:${12+Math.random()*20}s;animation-delay:${Math.random()*16}s;`;
    p.appendChild(d);
  }
})();

// Keyboard shortcuts
document.addEventListener('keydown',e=>{
  if(e.key==='Enter'&&!e.shiftKey&&!answered){
    const cb=document.getElementById('checkBtn');
    if(cb&&!cb.disabled)cb.click();
  }
  if(e.key==='n'&&answered){
    const nb=document.getElementById('nextBtn');
    if(nb&&nb.style.display!=='none')nb.click();
  }
});

// Question bank (condensed)
const QB={
  syntax:[
    {q:"What will this code output?",c:"x = 10\ny = 3\nprint(x // y)",o:["3.33","3","4","3.0"],a:1,e:"// is floor division â€” divides and rounds DOWN. 10 // 3 = 3.",d:"easy",p:10},
    {q:"Which operator raises a number to a power?",o:["^","**","pow","exp"],a:1,e:"** is the power operator. 2**3 = 8. Note: ^ means XOR in Python.",d:"easy",p:10},
    {q:"What will this code output?",c:"print('Hello' + ' ' + 'World')",o:["HelloWorld","Hello World","Hello+World","Error"],a:1,e:"+ joins strings. 'Hello' + ' ' + 'World' = 'Hello World'.",d:"easy",p:10},
    {q:"What will this code output?",c:"text = 'Python'\nprint(text[0] + text[-1])",o:["Pn","Py","on","Error"],a:0,e:"text[0] is first 'P'. text[-1] is last 'n'. Result: 'Pn'.",d:"medium",p:15},
    {q:"What data type does 5 / 2 return?",o:["int","float","str","bool"],a:1,e:"/ always returns a float. 5 / 2 = 2.5. Use // for int.",d:"easy",p:10}
  ],
  data:[
    {q:"What will this code output?",c:"fruits = ['apple', 'banana', 'cherry']\nfruits.append('orange')\nprint(len(fruits))",o:["3","4","5","Error"],a:1,e:"append() adds to the end. 3+1=4. len() counts items.",d:"easy",p:10},
    {q:"What will this code output?",c:"numbers = [1, 2, 3, 4, 5]\nprint(numbers[1:4])",o:["[1, 2, 3]","[2, 3, 4]","[1, 2, 3, 4]","[2, 3, 4, 5]"],a:1,e:"[1:4] = start at 1, stop before 4. Items at 1,2,3 are 2,3,4.",d:"medium",p:15},
    {q:"Which method removes the last list item?",o:["remove()","pop()","delete()","del()"],a:1,e:"pop() removes last. pop(0) removes first. remove(x) removes by value.",d:"easy",p:10},
    {q:"What will this code output?",c:"my_dict = {'a': 1, 'b': 2, 'c': 3}\nprint(my_dict['b'])",o:["1","2","3","b"],a:1,e:"Dicts use keys for values. my_dict['b'] returns 2.",d:"easy",p:10},
    {q:"What happens adding a duplicate to a set?",o:["Error","Added twice","Ignored","Set cleared"],a:2,e:"Sets hold unique values only. Duplicates are ignored.",d:"medium",p:15}
  ],
  funcs:[
    {q:"What will this print?",c:"def add_numbers(a, b):\n    result = a + b\n    return result\n\nprint(add_numbers(5, 3))",o:["5","3","8","53"],a:2,e:"Function adds 5+3=8, returns it, print() shows 8.",d:"easy",p:10},
    {q:"What does a function return with no return?",o:["0","None","False","''"],a:1,e:"Without return, Python returns None automatically.",d:"medium",p:15},
    {q:"What will this output?",c:"def greet(name='Guest'):\n    return f'Hello, {name}!'\n\nprint(greet())",o:["Hello, !","Hello, Guest!","Hello, name!","Error"],a:1,e:"name='Guest' is default. No arg = uses 'Guest'.",d:"medium",p:15},
    {q:"How do you call function 'calculate'?",o:["calculate[]","calculate()","call calculate","calculate{}"],a:1,e:"Functions use (). Args go inside: calculate().",d:"easy",p:10}
  ],
  loops:[
    {q:"What will this output?",c:"for i in range(3):\n    print(i)",o:["1 2 3","0 1 2","1 2","0 1 2 3"],a:1,e:"range(3) = 0,1,2. Starts at 0, stops before 3.",d:"easy",p:10},
    {q:"Which keyword exits a loop?",o:["exit","break","stop","end"],a:1,e:"break exits immediately. continue skips to next.",d:"easy",p:10},
    {q:"What will this output?",c:"count = 0\nwhile count < 3:\n    count += 1\nprint(count)",o:["2","3","4","0"],a:1,e:"count goes 0â†’1â†’2â†’3. When 3, count<3 is False. Prints 3.",d:"medium",p:15},
    {q:"What does range(2, 8, 2) generate?",o:["2, 4, 6","2, 4, 6, 8","2,3,4,5,6,7","4, 6, 8"],a:0,e:"range(start,stop,step): 2,4,6. Stops before 8.",d:"medium",p:15}
  ],
  cond:[
    {q:"What will this output?",c:"x = 15\nif x > 10:\n    print('Big')\nelse:\n    print('Small')",o:["Big","Small","15","Error"],a:0,e:"15>10 is True. if-block runs. else skipped.",d:"easy",p:10},
    {q:"Which checks extra conditions after if?",o:["elseif","elif","else if","ifelse"],a:1,e:"elif = 'else if'. Tests more conditions.",d:"easy",p:10},
    {q:"What operator means 'not equal'?",o:["<>","!=","=/=","not="],a:1,e:"!= = not equal. 5!=3 is True. == = equal.",d:"easy",p:10},
    {q:"What will this output?",c:"x = 5\nresult = 'Even' if x % 2 == 0 else 'Odd'\nprint(result)",o:["Even","Odd","5","True"],a:1,e:"% = remainder. 5%2=1 (not 0). Condition False. result='Odd'.",d:"medium",p:15}
  ],
  libs:[
    {q:"Which library has sqrt?",o:["mathematics","math","calc","numpy"],a:1,e:"math library: math.sqrt(), math.sin(), math.pi.",d:"easy",p:10},
    {q:"Which generates random numbers?",o:["random","rand","randomize","numbers"],a:0,e:"import random: random.randint(), random.choice().",d:"easy",p:10},
    {q:"How import only sqrt from math?",o:["import math.sqrt","from math import sqrt","import sqrt from math","get sqrt from math"],a:1,e:"'from math import sqrt' = call sqrt() directly.",d:"medium",p:15},
    {q:"What does 'import math as m' allow?",o:["Import some","Use m.sqrt()","Import faster","Nothing"],a:1,e:"'as m' = nickname. Write m.sqrt() vs math.sqrt().",d:"medium",p:15}
  ]
};

const CQ=[
  {t:"Syntax",q:"Write code to print 'Hello, Python!' to the console.",h:"Use print() with text in quotes.",ans:"print('Hello, Python!')",va:["print('Hello, Python!')","print(\"Hello, Python!\")"],e:"print() displays text. Quotes hold the text.",d:"easy",p:10},
  {t:"Variables",q:"Create variable 'age' set to 25.",h:"Use = to assign.",ans:"age = 25",va:["age = 25","age=25"],e:"Variables store data. = assigns value.",d:"easy",p:10},
  {t:"Lists",q:"Create list 'colors' with 'red', 'green', 'blue'.",h:"Use [ ] with commas.",ans:"colors = ['red', 'green', 'blue']",va:["colors = ['red', 'green', 'blue']","colors = [\"red\", \"green\", \"blue\"]","colors=['red','green','blue']"],e:"Lists use [ ]. Items separated by commas.",d:"easy",p:10},
  {t:"Functions",q:"Define function 'double' taking 'x', returning x*2.",h:"Use def and return.",ans:"def double(x):\n    return x * 2",va:["def double(x):\n    return x * 2","def double(x):\n    return x*2","def double(x):return x*2","def double(x):\n  return x * 2"],e:"def creates function. return sends back result.",d:"medium",p:15},
  {t:"Loops",q:"Write for loop printing 0 to 4.",h:"Use range(5).",ans:"for i in range(5):\n    print(i)",va:["for i in range(5):\n    print(i)","for i in range(5):print(i)","for i in range(5):\n  print(i)"],e:"range(5)=0-4. for visits each. i holds current.",d:"medium",p:15},
  {t:"Conditionals",q:"Write if printing 'Positive' when num>0.",h:"Use if, condition, colon.",ans:"if num > 0:\n    print('Positive')",va:["if num > 0:\n    print('Positive')","if num > 0:\n    print(\"Positive\")","if num>0:print('Positive')","if num > 0:\n  print('Positive')"],e:"if checks condition. Indentation shows what's inside.",d:"easy",p:10},
  {t:"Strings",q:"Convert 'python' to uppercase.",h:"Use .upper() method.",ans:"'python'.upper()",va:["'python'.upper()","\"python\".upper()"],e:".upper() returns NEW string in capitals.",d:"medium",p:15},
  {t:"Lists",q:"Add 10 to end of list 'numbers'.",h:"Use .append() method.",ans:"numbers.append(10)",va:["numbers.append(10)"],e:"append() adds to END. Modifies list directly.",d:"easy",p:10},
  {t:"Dicts",q:"Create dict 'person' with key 'name' = 'Alice'.",h:"Use { } with key:value.",ans:"person = {'name': 'Alice'}",va:["person = {'name': 'Alice'}","person = {\"name\": \"Alice\"}","person={'name':'Alice'}"],e:"Dicts hold key:value in { }. Like word:definition.",d:"medium",p:15},
  {t:"Loops",q:"Write while loop printing 1 to 3.",h:"Counter, while condition, increment.",ans:"i = 1\nwhile i <= 3:\n    print(i)\n    i += 1",va:["i = 1\nwhile i <= 3:\n    print(i)\n    i += 1","i=1\nwhile i<=3:print(i);i+=1","i = 1\nwhile i <= 3:\n  print(i)\n  i += 1"],e:"while repeats while True. Increment or infinite loop!",d:"medium",p:15}
];

const motivations=[
  "ğŸŒŸ Every line of code is a step to building something amazing!",
  "ğŸ’ª Mistakes are learning in disguise. Keep going!",
  "ğŸš€ You're not learning Python â€” you're building a superpower!",
  "ğŸ§  Best time to start was yesterday. Next best? Right now!",
  "ğŸ¯ Consistency beats talent. Show up daily, surprise yourself!",
  "ğŸ”‘ Every concept unlocks doors to new possibilities.",
  "âš¡ One wrong answer teaches more than five right!",
  "ğŸŒ± You started from zero. Look how far you've come!",
  "ğŸ† World-class devs Googled these same things!",
  "âœ¨ Code is English with extra precision. You've got this!"
];

const levels=[
  {n:"ğŸŒ± Seedling",m:0},{n:"ğŸ£ Hatchling",m:50},{n:"âš¡ Spark",m:120},
  {n:"ğŸ”¥ Coder",m:250},{n:"ğŸ’ Developer",m:450},{n:"ğŸš€ Pythonista",m:700},{n:"ğŸŒŸ Pro",m:1000}
];

const achievements=[
  {i:'first',t:s=>s.total===1,ic:'ğŸ‰',ti:'First Step!',m:'You answered your first question!'},
  {i:'s3',t:s=>s.streak===3,ic:'ğŸ”¥',ti:'On Fire!',m:'3 in a row!'},
  {i:'s5',t:s=>s.streak===5,ic:'âš¡',ti:'Lightning!',m:'5 in a row â€” incredible!'},
  {i:'ten',t:s=>s.total===10,ic:'ğŸ…',ti:'10 Done!',m:'Real momentum!'},
  {i:'p5',t:s=>s.correct===5&&s.total===5,ic:'ğŸ’',ti:'Perfect 5!',m:'Flawless!'},
  {i:'c100',t:s=>s.xp>=100,ic:'ğŸŒŸ',ti:'100 XP!',m:'Levelled up!'}
];
const earned=new Set();

let stats={total:0,correct:0,streak:0,bestStreak:0,xp:0};
let answered=false,qType=null,curQ=null,qNum=0;
let retryCount=0,retryMode=false;

function rand(){
  qType=Math.random()<0.6?'mc':'code';
  if(qType==='mc'){
    const cats=Object.keys(QB);
    const cat=cats[Math.floor(Math.random()*cats.length)];
    const pool=QB[cat];
    curQ={...pool[Math.floor(Math.random()*pool.length)]};
    curQ.topic=cat.charAt(0).toUpperCase()+cat.slice(1);
  }else{
    curQ={...CQ[Math.floor(Math.random()*CQ.length)]};
  }
  return curQ;
}

function hl(code){
  return code
    .replace(/</g,'&lt;').replace(/>/g,'&gt;')
    .replace(/\b(def|return|if|else|elif|for|while|in|range|import|from|as|class|True|False|None|not|and|or|is|lambda|pass|break|continue|try|except|with|yield)\b/g,'<span class="kw">$1</span>')
    .replace(/\b(print|len|append|pop|str|int|float|list|dict|set|type|input|open|sum|min|max|abs)\b/g,'<span class="fn">$1</span>')
    .replace(/('(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*")/g,'<span class="str">$1</span>')
    .replace(/\b(\d+\.?\d*)\b/g,'<span class="num">$1</span>')
    .replace(/(#[^\n]*)/g,'<span class="cmt">$1</span>');
}

function norm(code){
  code=code.replace(/#[^\n]*/g,'');
  const lines=code.split('\n').map(l=>l.trimEnd()).filter(l=>l.trim());
  const normalized=lines.map(line=>{
    const indent=line.match(/^\s*/)[0].length;
    const level=Math.floor(indent/2);
    return '    '.repeat(level)+line.trim();
  });
  return normalized.join('\n').replace(/["']/g,"'").toLowerCase();
}

function loadQ(){
  const q=rand();
  qNum++;
  retryCount=0;
  retryMode=false;

  if(qNum%3===0){
    document.getElementById('motivationText').textContent=motivations[Math.floor(Math.random()*motivations.length)];
  }

  const breakdown=`
    <div class="breakdown" id="breakdown">
      <div class="breakdown-header">
        <div class="breakdown-header-icon">ğŸ§©</div>
        <div class="breakdown-header-info">
          <div class="breakdown-header-title">Step-by-Step Breakdown</div>
          <div class="breakdown-header-sub">Every part explained Â· With live examples</div>
        </div>
      </div>
      <div class="breakdown-content" id="breakdownContent"></div>
    </div>`;

  let html=`<div class="q-meta">
    <span class="q-number">Question #${qNum}</span>
    <span class="q-points">+${q.p} XP</span>
  </div>
  <div class="q-header">
    <span class="q-type">${qType==='mc'?'ğŸ”¢ Multiple Choice':'âŒ¨ï¸ Code Challenge'}</span>
    <span class="topic">${q.t||q.topic}</span>
    <span class="difficulty difficulty-${q.d}">${q.d.toUpperCase()}</span>
  </div>
  <div class="question">${q.q}</div>`;

  if(qType==='mc'){
    if(q.c) html+=`<div class="code-block">${hl(q.c)}</div>`;
    html+='<div class="options">';
    q.o.forEach((op,i)=>{
      html+=`<div class="option" onclick="pick(${i})">
        <div class="option-letter">${String.fromCharCode(65+i)}</div>
        <div class="option-text">${op}</div>
      </div>`;
    });
    html+=`</div>
      <div class="explanation" id="expl">
        <div class="explanation-title">ğŸ’¡ Answer Explained</div>
        <div class="explanation-text">${q.e}</div>
      </div>
      ${breakdown}
      <div class="buttons">
        <button class="btn-primary" id="checkBtn" onclick="checkMC()" disabled>Check Answer</button>
        <button class="btn-primary" id="nextBtn" onclick="loadQ()" style="display:none;">Next Question â†’</button>
        <button class="btn-explain" id="breakBtn" onclick="doBreak()" style="display:none;">ğŸ§© Break It Down</button>
      </div>`;
  }else{
    html+=`
      <div class="code-input-area">
        <div class="hint-box">
          <div class="hint-icon">ğŸ’¡</div>
          <div>
            <div class="hint-label">Hint</div>
            <div class="hint-text">${q.h}</div>
          </div>
        </div>
        <textarea class="code-input" id="codeInput" placeholder="# Write your Python code here..." spellcheck="false"></textarea>
      </div>
      <div class="feedback" id="fb"></div>
      <div class="explanation" id="expl">
        <div class="explanation-title">âœ… Solution</div>
        <div class="explanation-text">${q.e}</div>
        <div class="code-block" style="margin-top:14px;">${hl(q.ans)}</div>
      </div>
      ${breakdown}
      <div class="buttons">
        <button class="btn-primary" onclick="checkCode()">Check My Code</button>
        <button class="btn-primary" id="nextBtn" onclick="loadQ()" style="display:none;">Next Question â†’</button>
        <button class="btn-secondary" onclick="reveal()">Show Solution</button>
        <button class="btn-explain" id="breakBtn" onclick="doBreak()" style="display:none;">ğŸ§© Break It Down</button>
      </div>`;
  }

  document.getElementById('quizContent').innerHTML=html;
  answered=false;
}

function pick(i){
  if(answered)return;
  document.querySelectorAll('.option').forEach(o=>o.classList.remove('selected'));
  document.querySelectorAll('.option')[i].classList.add('selected');
  document.getElementById('checkBtn').disabled=false;
  window.sel=i;
}

function checkMC(){
  if(answered)return;
  const q=curQ;

  if(window.sel===q.a){
    answered=true;stats.total++;
    stats.correct++;stats.streak++;
    if(stats.streak>stats.bestStreak)stats.bestStreak=stats.streak;
    stats.xp+=retryMode?Math.ceil(q.p/2):q.p;
    document.querySelectorAll('.option')[q.a].classList.add('correct');
    if(retryMode)toast('ğŸ’ª','Got it!','Retrying is how real learning happens!');
    afterAns(true);
  }else{
    retryCount++;
    const wo=document.querySelectorAll('.option')[window.sel];
    wo.classList.add('incorrect');
    wo.style.animation='shake 0.45s ease';
    setTimeout(()=>{wo.style.animation='';wo.classList.remove('incorrect','selected');},460);
    showRetry('mc');
    window.sel=undefined;
    document.getElementById('checkBtn').disabled=true;
  }
}

function checkCode(){
  const val=document.getElementById('codeInput').value.trim();
  const fb=document.getElementById('fb');
  if(!val){fb.className='feedback show incorrect';fb.innerHTML='<span>âš ï¸</span> Please type code first.';return;}

  const ok=curQ.va.some(a=>norm(a)===norm(val));

  if(ok){
    answered=true;stats.total++;
    stats.correct++;stats.streak++;
    if(stats.streak>stats.bestStreak)stats.bestStreak=stats.streak;
    stats.xp+=retryMode?Math.ceil(curQ.p/2):curQ.p;
    fb.className='feedback show correct';
    fb.innerHTML='<span>âœ…</span> '+(retryMode?'Got it! Great persistence!':'Correct! Your code is right!');
    if(retryMode)toast('ğŸ’ª','Got it!','Retrying is how real learning happens!');
    afterAns(true);
  }else{
    retryCount++;
    fb.className='feedback show incorrect';
    const ta=document.getElementById('codeInput');
    ta.style.borderColor='var(--red)';
    setTimeout(()=>{ta.style.borderColor='';},700);
    fb.innerHTML='<span>âŒ</span> Not quite â€” check and try again!';
    showRetry('code');
  }
}

function showRetry(type){
  retryMode=true;
  const old=document.getElementById('retryBadge');
  if(old)old.remove();

  const badge=document.createElement('div');
  badge.id='retryBadge';
  badge.className='retry-badge';
  badge.innerHTML=`âš ï¸ Attempt ${retryCount+1} Â· <strong>Wrong!</strong> Try again or give up.`;

  const btns=document.querySelector('.buttons');
  const cb=document.getElementById('checkBtn');
  if(cb)cb.disabled=true;

  let rb=document.getElementById('retryBtn');
  let gb=document.getElementById('giveupBtn');

  if(!rb){
    rb=document.createElement('button');
    rb.id='retryBtn';rb.className='btn-retry';
    btns.appendChild(rb);
  }
  rb.innerHTML='ğŸ”„ Try Again';
  rb.onclick=()=>doRetry(type);
  rb.style.display='flex';

  if(!gb){
    gb=document.createElement('button');
    gb.id='giveupBtn';gb.className='btn-secondary';
    btns.appendChild(gb);
  }
  gb.innerHTML='ğŸ³ï¸ Give Up';
  gb.onclick=giveUp;
  gb.style.display='flex';

  btns.insertAdjacentElement('beforebegin',badge);
}

function doRetry(type){
  const b=document.getElementById('retryBadge');
  if(b)b.remove();

  if(type==='mc'){
    document.querySelectorAll('.option').forEach(o=>{
      o.classList.remove('selected','correct','incorrect');
    });
    const cb=document.getElementById('checkBtn');
    if(cb){cb.style.display='inline-flex';cb.disabled=true;}
  }else{
    const ta=document.getElementById('codeInput');
    if(ta){ta.style.borderColor='';ta.focus();}
    const fb=document.getElementById('fb');
    if(fb){fb.className='feedback';fb.innerHTML='';}
  }

  const rb=document.getElementById('retryBtn');
  const gb=document.getElementById('giveupBtn');
  if(rb)rb.style.display='none';
  if(gb)gb.style.display='none';
}

function giveUp(){
  answered=true;stats.total++;
  stats.streak=0;
  upStats();

  if(qType==='mc'){
    document.querySelectorAll('.option')[curQ.a].classList.add('correct');
    if(window.sel!==undefined)
      document.querySelectorAll('.option')[window.sel]?.classList.add('incorrect');
  }

  if(qType==='code'){
    const fb=document.getElementById('fb');
    if(fb){fb.className='feedback show incorrect';fb.innerHTML='<span>ğŸ³ï¸</span> Study the answer and try next time!';}
  }

  const rb=document.getElementById('retryBtn');
  const gb=document.getElementById('giveupBtn');
  const badge=document.getElementById('retryBadge');
  if(rb)rb.style.display='none';
  if(gb)gb.style.display='none';
  if(badge)badge.remove();

  afterAns(false);
  toast('ğŸ“–','Answer Revealed','Study it, nail the next one!');
}

function afterAns(wasCorrect){
  if(wasCorrect!==false&&!answered){
    answered=true;stats.total++;
  }
  upStats();checkAch();
  document.getElementById('expl').classList.add('show');
  const cb=document.getElementById('checkBtn');
  if(cb)cb.style.display='none';
  const rb=document.getElementById('retryBtn');
  const gb=document.getElementById('giveupBtn');
  if(rb)rb.style.display='none';
  if(gb)gb.style.display='none';
  const badge=document.getElementById('retryBadge');
  if(badge)badge.remove();
  document.getElementById('nextBtn').style.display='block';
  document.getElementById('breakBtn').style.display='flex';
}

function reveal(){
  document.getElementById('expl').classList.add('show');
  document.getElementById('breakBtn').style.display='flex';
  if(!answered)giveUp();
}

function upStats(){
  document.getElementById('statTotal').textContent=stats.total;
  document.getElementById('statCorrect').textContent=stats.correct;
  document.getElementById('statAccuracy').textContent=stats.total>0?Math.round(stats.correct/stats.total*100)+'%':'â€”';
  document.getElementById('statStreak').textContent=stats.streak+(stats.streak>=5?' ğŸ”¥':stats.streak>=3?' â­':'');
  document.getElementById('statBest').textContent=stats.bestStreak;

  const lvl=levels.slice().reverse().find(l=>stats.xp>=l.m)||levels[0];
  const next=levels[levels.indexOf(lvl)+1];
  const pct=next?Math.min(100,Math.round((stats.xp-lvl.m)/(next.m-lvl.m)*100)):100;
  document.getElementById('xpFill').style.width=pct+'%';
  document.getElementById('xpPoints').textContent=stats.xp+(next?' / '+next.m:'')+' XP';
  document.getElementById('levelValue').textContent=lvl.n;
}

function checkAch(){
  achievements.forEach(a=>{
    if(!earned.has(a.i)&&a.t(stats)){
      earned.add(a.i);
      toast(a.ic,a.ti,a.m);
    }
  });
}

function toast(icon,title,msg){
  const t=document.getElementById('toast');
  document.getElementById('toastIcon').textContent=icon;
  document.getElementById('toastTitle').textContent=title;
  document.getElementById('toastMsg').textContent=msg;
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'),4000);
}

// Google Forms Feedback Integration
function openFeedback(){
  // Replace this URL with your actual Google Form URL
  const formURL='https://docs.google.com/forms/d/e/1FAIpQLSfPZYvA-bXVHuLuPdDHl7UvLcxdJQXvPU3UkvNZYvQfL_ZBAQ/viewform?usp=pp_url&entry.123456789='+encodeURIComponent(window.location.href);
  window.open(formURL,'_blank','width=700,height=800');
}

async function doBreak(){
  const btn=document.getElementById('breakBtn');
  const box=document.getElementById('breakdown');
  const cont=document.getElementById('breakdownContent');
  btn.disabled=true;
  box.classList.add('show');
  cont.innerHTML=`<div class="loading"><div class="spinner"></div>Building your guideâ€¦</div>`;
  box.scrollIntoView({behavior:'smooth',block:'nearest'});

  const q=curQ,isCode=qType==='code';
  const ctx=isCode
    ?`TASK: "${q.q}"\nTOPIC: ${q.t}\nANSWER:\n${q.ans}\nEXPL: ${q.e}`
    :`Q: "${q.q}"\nTOPIC: ${q.topic}\n${q.c?'CODE:\n'+q.c+'\n':''}ANSWER: ${q.o[q.a]}\nEXPL: ${q.e}`;

  const prompt=`World-class Python tutor teaching complete beginner (never coded).

${ctx}

Break into steps. Each step = concept + RUNNABLE CODE EXAMPLE showing JUST that concept.

FORMAT (exact markers):

[WHAT]
"This is about [concept] â€” [plain English]."

[STEP_1_TITLE]
Plain title
[STEP_1_BODY]
Explanation (4 sentences max). Explain every symbol.
[STEP_1_CODE]
# Short runnable example (2-5 lines)
code_here
[STEP_1_OUTPUT]
Exact output or result

(STEP_2, STEP_3... as needed)

[ANALOGY]
2-sentence real-life analogy (cooking, shopping, LEGO).

[TIP]
1 sentence: when will beginner use this?

RULES:
- Never: "simple","just","easy","basic"
- Code examples SHORT, demonstrate ONE thing
- Explain every symbol: dot, parens, colon, brackets
- Output = exact Python result`;

  try{
    const res=await fetch("https://api.anthropic.com/v1/messages",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({
        model:"claude-sonnet-4-20250514",
        max_tokens:1000,
        messages:[{role:"user",content:prompt}]
      })
    });
    const data=await res.json();
    const raw=(data.content?.map(b=>b.text||'').join('')||'').trim();
    if(!raw)throw new Error('empty');
    cont.innerHTML=renderBreak(raw);
  }catch(e){
    cont.innerHTML=`<div style="color:#b00;padding:10px 0;">Error loading. Try again.</div>`;
  }finally{
    btn.disabled=false;
    btn.innerHTML='ğŸ”„ Explain Again';
  }
}

function renderBreak(raw){
  let html='';

  const wm=raw.match(/\[WHAT\]([\s\S]*?)(?=\[STEP_1_TITLE\])/);
  if(wm){
    html+=`<div class="what-is">
      <div class="what-icon">ğŸ“Œ</div>
      <div class="what-text">${wm[1].trim()}</div>
    </div>`;
  }

  const sr=/\[STEP_(\d+)_TITLE\]([\s\S]*?)\[STEP_\1_BODY\]([\s\S]*?)\[STEP_\1_CODE\]([\s\S]*?)\[STEP_\1_OUTPUT\]([\s\S]*?)(?=\[STEP_\d+_TITLE\]|\[ANALOGY\]|\[TIP\]|$)/g;
  let m;
  while((m=sr.exec(raw))!==null){
    const num=m[1];
    const title=m[2].trim();
    const body=m[3].trim()
      .replace(/`([^`]+)`/g,'<code style="background:#0f1419;color:#90ee90;padding:2px 7px;border-radius:5px;font-family:monospace;font-size:0.91em;">$1</code>')
      .replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>')
      .replace(/\n/g,'<br>');
    const code=m[4].trim();
    const out=m[5].trim();

    html+=`<div class="step">
      <div class="step-header">
        <div class="step-num">${num}</div>
        <div class="step-title">${title}</div>
      </div>
      <div class="step-body">
        <div>${body}</div>
        <div class="example">
          <div class="example-header">
            <div class="example-dots">
              <div class="dot dot-r"></div>
              <div class="dot dot-y"></div>
              <div class="dot dot-g"></div>
            </div>
            <span class="example-label">example.py</span>
          </div>
          <div class="example-code">${hl(code)}</div>
          ${out?`<div class="example-output">
            <div class="output-label">â–¶ Output</div>
            <div class="output-value">${out.replace(/\n/g,'<br>')}</div>
          </div>`:''}
        </div>
      </div>
    </div>`;
  }

  const am=raw.match(/\[ANALOGY\]([\s\S]*?)(?=\[TIP\]|$)/);
  if(am){
    html+=`<div class="analogy">
      <div class="analogy-icon">ğŸŒ</div>
      <div>
        <div class="analogy-title">Real-Life Analogy</div>
        <div class="analogy-text">${am[1].trim().replace(/\n/g,'<br>')}</div>
      </div>
    </div>`;
  }

  const tm=raw.match(/\[TIP\]([\s\S]*?)$/);
  if(tm){
    html+=`<div class="tip">
      <div class="tip-icon">ğŸš€</div>
      <div>
        <div class="tip-title">When You'll Use This</div>
        <div class="tip-text">${tm[1].trim()}</div>
      </div>
    </div>`;
  }

  if(!html.trim())html=`<div style="line-height:1.8;">${raw.replace(/\n/g,'<br>')}</div>`;
  return html;
}

loadQ();
upStats();
</script>
</body>
</html>
